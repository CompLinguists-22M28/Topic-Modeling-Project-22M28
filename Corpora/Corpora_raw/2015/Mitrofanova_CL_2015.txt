ВЕРОЯТНОСТНОЕ МОДЕЛИРОВАНИЕ ТЕМАТИКИ РУССКОЯЗЫЧНЫХ КОРПУСОВ ТЕКСТОВ
С ИСПОЛЬЗОВАНИЕМ КОМПЬЮТЕРНОГО
ИНСТРУМЕНТА GENSIM
1. Тематическое моделирование как исследовательская задача
Тематическое моделирование – способ построения модели корпуса текстов, отражающий переход от совокупности документов и совокупности слов к набору тем, характеризующих содержание документов. Тематические модели – модели со скрытыми переменными, для выявления которых лучше всего подходит нечеткая кластеризация. Тем самым, любое слово или документ с той или иной вероятностью относится к разным темам. 
В тематической модели текстовой коллекции описанию документов ставится в соответствие смесь вероятностных распределений на множестве тем. Это означает, что текст состоит из слов, выбранных случайным образом из смеси распределений, и тогда построение тематической модели предполагает восстановление компонент этой смеси. Вероятностная модель порождения данных может быть представлена следующим образом: p(w|d) = Σp(t|d)p(w|t), где p(w|d) – известная частота появления слова w в тексте d, p(w|t) – неизвестная вероятность появления слова w в теме t, p(t|d) – неизвестная вероятность появления темы t в тексте d. Построить тематическую модель текстового корпуса D – значит найти множество тем T, распределения p(w|t) для всех тем и p(t|d) для всех документов. Искомые распределения дают сжатое тематическое описание документов, пригодных для решения задач NLP (классификация, кластеризация лексики и документов, разрешение лексической неоднозначности, индексирование, построение онтологий, работа с многоязычными тематическими коллекциями и т.д.).
При построении тематической модели используется машинное обучение без учителя, это итеративный процесс, представляющий собой разновидность решения задачи оптимизации. Подход к тематическому моделированию, взятый на вооружение в нашем исследовании, по сути своей связан с инженерией знаний. Состоятельность данного подхода подкрепляется лингвистическими наблюдениями о том, что 1) слова, связанные между собой по значению, должны регулярно соседствовать друг с другом в контекстах [Шайкевич 1963], 2) существует согласованность расстояний между словами внутри текста и внутри тезауруса [Шрейдер 1963], 3) повторяющиеся в тексте значения формируют так называемую тематическую сетку текста [Арнольд 1984]. Как инженерный, так и лингвистический подходы приводят к схожим результатам: совокупности документов ставится в соответствие набор тем – кластеры слов, характеризуемых совместной встречаемостью и семантической близостью в пределах корпуса текстов. Изящная интеграция двух подходов, основанная на методике дистрибутивно-статистического анализа, применяется, например, в работе [Шайкевич, Савчук 2014].
2. Практическое решение задачи вероятностного тематического моделирования
Во множестве тематических моделей противопоставляются алгебраические (например, стандартная векторная модель текста VSM и латентно-семантический анализ LSA) и вероятностные (вероятностный латентно-семантический анализ pLSA и латентное размещение Дирихле LDA). Наиболее перспективным в обработке больших текстовых коллекций признан алгоритм LDA. Существует обширная библиография по тематическому моделированию англоязычных корпусов текстов [Blei et al. 2003, Daud et al. 2010, Topic Modelling Bibliography. http://mimno.infosci.cornell. edu/topics. html]. 
В основном, процедуры тематического моделирования проводятся для научных и публицистических текстов. Есть также опыт применения тематических моделей для анализа поэтических текстов. Вместе с тем, материал русскоязычных текстовых коллекций практически не охвачен. Положительный опыт связан с исследованиями лаборатории ЛИНИС НИУ ВШЭ [Bodrunova et al. 2013] и группы К.В. Воронцова [Vorontsov, Potapenko 2014]. Ранее мы проводили эксперименты, где был реализован более простой вариант нечеткой кластеризации русских текстов с целью стилистической диагностики и характеристики сюжета [Mitrofanova 2009], также проводилась работа с англоязычными текстами разных стилей с использованием инструмента TMT [Митрофанова 2014]. Целью настоящего исследования является адаптация инструмента тематического моделирования GenSim для анализа русскоязычных текстов и проверка гипотезы о зависимости результатов тематического моделирования от типов текстов.
3. Лингвистические данные, их подготовка и предобработка
В экспериментах были задействованы специализированные корпусные ресурсы, которыми располагает кафедра математической лингвистики СПбГУ: это корпусы научных текстов (тематика: космос, медицина, теория вероятностей, математические задачи, мореплавание, кулинария, корпусная лингвистика, радиоэлектроника, научно-популярные тексты общего характера), а также художественные тексты отечественных прозаиков (в частности, В.К. Арсеньева, Ю.П. Германа, А.С. Грина, М.М. Пришвина и др.) и коллекция русских сказок в обработке А.В. Афанасьева. Объемы обработанных фрагментов текстовых коллекций составляют от 200 тыс. с/у до 1 млн с/у. 
Процедура предобработки анализируемых текстовых корпусов включает следующие этапы: 1) удаление нетекстовых элементов: рисунков, таблиц, формул, гиперссылок и т.д.; 2) создание стоп-словаря на основе Корпусного словаря неоднословных лексических единиц (оборотов) НКРЯ (http://www.ruscorpora.ru/ obgrams.html) и частотных списков лемм служебных частей речи, местоимений, числительных, аббревиатур из ЧССРЯ НКРЯ (http://dict.ruslang.ru/freq.php), а также списка латинских символов, знаков пунктуации и цифровых обозначений); 3) лемматизация и автоматическое разрешение морфологической неоднозначности с помощью mystem 3.0 (https://tech.yandex.ru/mystem/); 4) разбиение текстов на документы сообразно их первоначальной логической структуре (главы, разделы и т.д.).
4. Компьютерный инструмент GenSim и компьютерная реализация LDA
В нашем исследовании задача тематического моделирования решается с помощью открытого компьютерного инструмента GenSim (http://radimrehurek.com/gensim/). GenSim – это набор библиотек Python, создателем которого является Р. Ржегуржек (R. Řehůřek). GenSim позволяет строить векторные и статистические модели текстовых корпусов. В составе GenSim есть модуль векторизации: внедрен алгоритм word2vec, проводятся операции построения матриц совместной встречаемости, вычисления коэффициента tf-idf, оценки близости контекстных векторов, построения модели LSA (Latent Semantic Analysis) и т.п. GenSim оснащен статистическим модулем, позволяющим строить вероятностные тематические модели корпусов текстов на основе LDA. Преимущество использования GenSim состоит в легкости его настройки для обработки русскоязычных текстов. 
На основе компонентов GenSim был составлен скрипт, производящий автоматический анализ текстов с помощью модели LDA. Скрипт предусматривает следующие этапы анализа: (1) создание словаря из файла с обрабатываемым корпусом текстов (формат *.txt, кодировка UTF8), при этом словарь являет собой список лемм с указанием порядковых номеров и частот в текстах; (2) удаление стоп-слов, считываемых из стоп-словаря, и низкочастотных слов; (3) преобразование словаря в матрицу; (4) реализация LDA c разными параметрами, при этом пользователь самостоятельно задает число итераций, число тем, объем тем; (5) вывод результатов: автоматически рассчитывается перплексивность, приводятся темы в виде списков лемм, для которых также указывается степень тяготения к теме. В примерах из раздела 5 (см. ниже) количественные данные скрыты.
5. Результаты экспериментов и их интерпретация
Был проведен анализ научных и научно-популярных текстов с точки зрения их тематики. Эксперименты проводились со следующими параметрами: число итераций – 10; число тем – 10, 20, 50, 100; объем тем – 10 лемм. Ниже приведены фрагменты выдачи для текстового массива детской энциклопедии А. Ликума «Всё обо всём» (Т. 1–5. М., 1997.). Автоматически сформированные темы покрывают как естественнонаучные, так и гуманитарные области знаний, представляя их с большей или меньшей детальностью:
Тема: «Астрономия»: Солнце, Земля, солнечный, расстояние, км, система, планета, год, находиться, время…
Тема «Анатомия и физиология»: тело, волос, собака, орган, мышца, мозг, сон, нервный, кость, ухо…
Тема «География»: Америка, северный, южный, Европа, год, индеец, Африка, период, Земля, полюс…
Тема «История древнего мира»: древний, римлянин, грек, греческий, каменный, середина, буря, театр, тысяча, Рим…
Тема «Материалы»: золото, порода, содержать, песок, материал, чистый, содержаться, тонна, горный, соединение…
Тема «Звук»: звук, волна, связка, голосовой, речь, вибрировать, произносить, эхо, мощный, звуковой…
Тема «Питание»: пища, зуб, рот, есть, ткань, сахар, питание, плод, рис, большой…
При анализе научного корпуса русскоязычных статей по корпусной лингвистике («Материалы международной конференции “Корпусная лингвистика”». СПб., 2006, 2008.) были получены темы, соответствующие отдельным направлениям исследований, например:
Тема «Разработка корпусов»: корпус, язык, русский, текст, работа, национальный, проект, материал, лингвистический…
Тема «Морфология в корпусе»: речь, часть, корпус, язык, предлог, частица, текст, слово, морфологический, единица…
Тема «Синтаксис в корпусе»: слово, текст, корпус, предложение, глагол, парсер, язык, синтаксический, являться, связь…
Тема «Семантика в корпусе»: значение, семантический, слово, неоднозначность, имя, глагол, контекст, случай, пример, класс…
Тема «Формальные онтологии»: онтология, понятие, отношение, возможность, рамка, экземпляр, использование, класс, иерархия …
По этим и другим результатам можно судить о том, что научно-популярные тексты передают фактическую информацию, характеризуются большим разнообразием тем, при этом объем пересечений между темами незначителен, в темах преобладает именная лексика.
При автоматическом анализе художественных текстов складывается несколько иная картина. Так, в экспериментах с корпусом русских сказок («Народные русские сказки А.Н. Афанасьева» Т. 1–3. М., 1957–1958) мы выделили два типа тем:
(1) темы, связанные с общей структурой сказочного сюжета, например:
Тема «Герои сказок» (1) поп, работник, казак, попадья, мужик, зараз, мертвец, лошадь, парень, батюшка…
Тема «Герои сказок» (2): сын, девица, купеческий, купец, красный, дочь, молодец, говорить, сестра, отец…
Тема «Сказки о животных»: петух, лиса, коза, запевать, кот, лес, окошко, хотеть, коготь, уходить…
Тема «Объекты в сказках»: короб, блюдечко, колодезь, сажа, заря, улица, срезать, наскоро, катиться, котенок…
Тема «Действия главных героев сказок»: говорить, давать, сказать, взять, пойти, лететь, садиться, большой, голова, лес…
(2) темы, связанные с определенными сказочными сюжетами, например:
Тема сказки «Сестрица Аленушка и братец Иванушка»: Аленушка, кипучий, пастись, подружка, сеть, пруд, оборачивать, зоря, наводить, пускать…
Тема сказки «Финист Ясный Сокол»: девица, красный, Василиса, дочь, избушка, Сокол, Ясный, сестра, море, золотой…
Тема сказок об Иване Царевиче: царевич, Иван, конь, богатырь, прекрасный, Баба-Яга, брат, сила, Елена, поехать…
Тема сказок об Алеше Поповиче: королевна, князь, ведьма, Яга, Алеша, король, мелкий, лебедь, говорить, Попович…
Тема сказки «Волк и лиса»: волк, говорить, старик, лиса, медведь, мужик, пойти, старуха, приходить, давать…
В то же время, тематическое моделирование описательных текстов (например, М.М. Пришвин. «Зеленый шум: Сборник рассказов». М., 1983.) или текстов с динамическим сюжетом, изобилующих диалогами (Ю.П. Герман. «Дорогой мой человек». М., 1990), дает особые результаты. Так, в текстах М.М. Пришвина присутствуют темы, характеризующие взаимоотношения человека и природы (например, общая тема: человек, время, лес, собака, очень, медведь, становиться, охота, заяц, охотник… и ее вариации), хотя выделены темы, связанные с определенным сюжетом и его героями (основная тема повести «Кладовая солнца»: Травка, болото, человек, Антипыч, собака, Митраша, тропа, Настя, заяц, клюква...). В трилогии Ю.П. Германа выделяются темы, содержащие имена главных героев и глаголы, присутствующие в диалогах (общая тема Володя, сказать, знать, Устименко, спрашивать, понимать, отвечать, Аглая, глаз, Цветков…), и надо заметить, что достаточно большая часть текста приходится именно на диалоги. 
Тем самым, с точки зрения построения тематической модели художественные тексты отличаются от научных в том, что в темах соседствует именная и глагольная лексика, описывающая состояние действующих лиц, природы, отражающая структуру диалогов, кроме того, темы могут пересекаться. 
6. Дальнейшие направления работы
Перспективы продолжения исследования связаны с решением следующих задач: 1) улучшение качества предобработки текстов; 2) морфологический анализ с помощью интегрированного анализатора PyMorphy+NLTK [Паничева и др. 2015]; 3) коррекция стоп-словаря; 4) исследование оптимальных параметров тематического моделирования с помощью LDA (число итераций, число тем) и других алгоритмов; 5) дальнейшее освоение GenSim; 6) расширение текстовой коллекции, работа с параллельными многоязычными текстами; 7) использование результатов тематического моделирования в стилистической диагностике.
