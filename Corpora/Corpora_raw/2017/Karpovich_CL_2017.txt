С. Н. Карпович
ВИЗУАЛИЗАЦИЯ ТЕМАТИЧЕСКИХ МОДЕЛЕЙ С ПОМОЩЬЮ IPYTHON
1.	Введение
Алгоритмы тематического моделирования являются одним из перспективных направлений машинного обучения и дистрибутивного анализа текстов на естественном языке. Дистрибутивный анализ — это метод исследования языка, основанный на изучении окружения отдельных единиц в тексте, не использующий сведений о полном лексическом или грамматическом значении этих единиц. Наиболее широко известны следующие дистрибутивно-семантические модели: модель векторных пространств, латентно-семантический анализ, тематическое моделирование, предсказательные модели дистрибутивной семантики.
Тематическое моделирование — это способ построения тематической модели коллекции текстовых документов. Тематическая модель (далее ТМ) позволяет группировать текстовые документы, определять, к каким темам относится каждый документ и какие слова (термины) образуют каждую тему.
При создании ТМ специалисту необходимо оценить качество построенной модели, получить представление о распределении слов и тем, выявить ошибки.
2.	Обзор существующих подходов к задаче визуализации результатов тематического моделирования
В работе [1] предложен метод визуализации ТМ, включающий программное обеспечение с открытым исходным кодом. Основная идея метода заключается в том, что визуализация модели обобщает и организует коллекцию документов. Каждая тема связывает несколько документов, и каждый документ связывает несколько тем. Пример представления показан на рисунке 1.
В работе [2] представлены инструменты для визуального анализа и оценки качества тематического моделирования. Предлагаемый подход содержит два основных интерфейса: отображение матрицы отношений слово-тема и отображение документа. ТМ представлена в виде матрицы, где строки — это слова, а столбцы — это темы. Система обладает продвинутым интерактивным графическим интерфейсом, реализованным с помощью JavaScript библиотеки d3.js.
Существуют несколько систем и инструментов для визуального анализа ТМ, но каждый из них обладает существенными недостатками. Поэтому задача визуализации результатов тематического моделирования, и разработка системы, позволяющей создавать и перестраивать ТМ, а затем представлять в интуитивно понятном виде промежуточные и итоговые результаты, по-прежнему актуальна.
3.	Подход к визуализации результатов тематического моделирования
ТМ задает отношение между темами и документами в корпусе текстов. Одна из самых распространенных ТМ — это латентное размещение Дирихле (LDA) [3], эта модель является обобщением вероятностного семантического индексирования. Другие ТМ, как правило, являются расширением LDA. Результатом тематического моделирования являются вероятностные распределения слов и документов по одной группе кластеров.
Требования к разрабатываемой системе: управление параметрами ТМ, выбор источника данных, модульность системы, подключение и замена необходимых программных библиотек, представление значимых слов для темы, отображение близости тем друг другу, интерактивная визуализация, представление темпоральной ТМ.
Для реализации системы были выбраны следующие средства: языковая платформа Python, интерактивная оболочка iPython, дистрибутив python Anaconda, библиотеки: gensim, pyldavis, matplotlib. Вместе выбранные программные средства обеспечивают необходимую функциональность для реализации программного комплекса. На рисунке 2 представлена архитектура системы визуализации ТМ с помощью iPython. Источником данных является корпус текстов SCTM-ru, модуль TM-LDA с помощью библиотеки gensim создает ТМ, модуль Calculate осуществляет предварительный расчет данных для визуализации ТМ на временном ряду, модуль Visualization отвечает за представление результата тематического моделирования.
В качестве примера визуализации создадим ТМ с помощью библиотеки gensim на специальном корпусе текстов SCTM-ru, впервые представленном в работе [4]. Первая версия корпуса была создана на данных сайта Русские Викиновости с 2005 по 2014 год. Используем вторую версию корпуса, в который добавлены новости до 2017 года. Стандартный вывод ТМ — это список наиболее вероятных слов для каждой темы с численной оценкой вероятности.
На рисунке 3 представлен интерактивный высокоуровневый интерфейс, созданный с помощью библиотеки pyLDAvis. В левой части с помощью диаграммы Элерра-Венна представлены темы. Представление позволяет оценить, насколько близки темы, те, что расположены рядом, находятся ближе, те, в которых общие слова встречаются реже, находятся дальше друг от друга. С правой стороны представлен набор слов, наиболее характерных для выбранной темы.
В практических задачах часто приходится иметь дело с анализом потока текстовых документов, например, потока новостей. В данной работе под текстовым потоком понимается последовательность текстовых документов с определенным для каждого документа временем создания. ТМ, анализирующие поток текстовых документов, называют темпоральными ТМ. Чтобы визуализировать динамику изменения тем во времени, необходимо провести предварительный расчет данных ТМ.
На рисунке 4 представлен следующий метод визуализации ТМ во времени, диаграмма-области построена на нормированных данных. Каждой теме соответствует свой цвет на диаграмме. Представление позволяет проследить повышение популярности или зарождение новой темы и снижение популярности другой.
С помощью библиотеки matplotlib возможна реализация представления темпоральных ТМ с помощью гистограмм и с диаграмм-линий.
4.	Заключение
В результате проделанной работы создана система для простого внедрения в рабочий процесс, с возможностью выбора подходящего метода визуализации и интуитивно понятным представлением результатов тематического моделирования. Особенностями системы являются гибкие возможности по настройке и управлению процесса создания ТМ, выбор источника данных и использование подходящих библиотек для визуализации. Наличие высокоуровневого интерфейса позволяет специалисту взаимодействовать с результатами тематического моделирования, в удобном виде представлять ТМ.
Поставленные в работе цели достигнуты. Разработанный подход может быть расширен новыми подходящими методами. Система доступна для свободного использования в некоммерческих целях.