В.А. Капустин
РАНГОВЫЕ СТАТИСТИКИ СОВМЕСТНОЙ ВСТРЕЧАЕМОСТИ СЛОВОФОРМ В БОЛЬШОЙ МОНОТЕМАТИЧЕСКОЙ КОЛЛЕКЦИИ
1. Введение
Основным предметом исследования в области ранговых статистик больших текстовых корпусов является частота встречаемости словоформ или лемм; немногие работы посвящены коллокациям. Исследователей коллокаций интересуют, в основном, частоты и статистические значимости конкретных, как правило, достаточно высокочастотных коллокаций .
В последнее время появились немногочисленные работы, посвящённые именно ранговым статистикам коллокаций (см., например, работу Р. Санчо и Р. Соле  и обзор ). В этих работах рассматриваются не частоты коллокаций, а так называемые «степени» словоформ, образующих коллокации – количество словоформ, участвующих в образовании коллокаций с данной словоформой, – и исследуются плотности распределений словоформ в зависимости от их степени. Причиной интереса к такой статистике является развитие в 90-е годы XX века т.н. теории эволюции сетей (подробный обзор см. в работе С. Дороговцева и Ж. Мендеса ). Эта теория позволяет делать нетривиальные предсказания о поведении сложной системы именно на основании формы распределения степеней вершин в графе сети. Особое внимание при этом уделяется степенным распределениям, которые (при некоторых показателях степени) обеспечивают уникальные свойства сети, например, малое среднее расстояние между её вершинами.
Работы группы Р. Соле выполнены на базе Британского Национального Корпуса (БНК) английского языка (в обзоре  приведены результаты для баскского и русского языков, но источники данных для этих исследований не указаны). В этих работах получены необычные распределения степеней вершин, имеющие излом (т.н. двухфрактальные распределения). Двухфрактальность наблюдается также и в исследованиях ранговых распределений частотности словоформ в БНК . 
В статье С. Дороговцева и Ж. Мендеса  предложена количественная сетевая модель развития языка, которая предлагает объяснение двухфрактальности распределений в больших корпусах наличием двух механизмов появления коллокаций: в небольшом ядре языка коллокации образуются, в основном, между словоформами этого ядра, а словоформы «периферии» чаще всего присоединяются к словоформам ядра. И в ядре, и на периферии языка, по мнению С. Дороговцева и Ж. Мендеса, по-разному реализуется общий механизм роста неравновесных сетей – «популярное притягивает», вероятность образования новой связи у вершины графа сети пропорциональна уже существующему количеству связей этой вершины. Размер ядра для БНК составил около 3 000 словоформ.
2. Постановка задачи
Неочевидно, что для флективных языков, каким является русский, имеет место двухфрактальность. Ранее автором совместно с А.А. Ямсен было выполнено исследование рангового распределения частотности словоформ на большой текстовой коллекции , и обнаружена двухфрактальность этого распределения с размером ядра, близким к размеру ядра БНК. Известно, однако, что ранговые распределения частотности слабо чувствительны к деталям строения сети .
Для более надёжного подтверждения гипотезы о существовании ядра языка, в котором характеристики совместной встречаемости словоформ отличаются от соответствующих характеристик на «периферии» языка, необходимо исследование других, более чувствительных к этому факту статистических характеристик, прежде всего – распределения частотности вершин-словоформ (далее –просто «вершин») по их степеням – количеству словоформ-партнёров, участвующих в коллокациях с данной словоформой.
Исследование распределения частотности вершин по их степеням выполнено нами на той же коллекции, что и исследование рангового распределения частотности словоформ – текстах российских законодательных актов 1999 г. Коллекция любезно предоставлена компанией «Кодекс» и насчитывает 60 308 текстов в формате HTML общим объемом около 1,5 Гбайта, включающие  примерно 60 млн словоупотреблений (словоформ).
Так же, как и в работе Р. Санчо и Р. Соле , словоформы считаются связанными, если выполнены два условия: (1) они находятся в одном предложении и (2) между ними находится ещё не более одной словоформы. Направление связи не учитывается. Для исследуемой коллекции характерно наличие несловесных текстовых фрагментов – обозначений дат, номеров документов, различных кодов и пр. Такие фрагменты (для них использовано обозначение #) не учитываются как члены контактных коллокаций, однако считаются «словоформой» при определении расстояния. Используемый подход соответствует т.н. «неограниченной сети слов» в исследовании Р. Санчо и Р. Соле («ограниченная сеть» получается учётом лишь тех коллокаций, частота которых выше произведения вероятностей соответствующих словоформ; объём «ограниченной сети» в указанном исследовании примерно на 10% меньше, чем «неограниченной», и статистические свойства обеих сетей практически совпадают).
3. Методика
HTML-документы коллекции были подвергнуты многоэтапной предварительной обработке:
•	удаление тегов HTML с перемаркировкой для учёта того, что, например, в ячейках таблиц встречаются жёсткие переносы, а абзацы HTML иногда не завершаются точкой;
•	замена символьных сущностей HTML (&nbsp;, &quot;)
•	анализ т.н. «текстовых таблиц» – примерно в 40% документов присутствуют таблицы, созданные с использованием неразрывных пробелов (как на пишущей машинке);
•	нормализация написания инициалов и стандартных сокращений с заменой точки на тире (Ельцин Б.Н. -> Б Н Ельцин, пгт. Зеленогорск -> пгт-Зеленогорск);
•	приведение к нижнему регистру;
•	удаление знаков препинания и некоторых видов «псевдослов» (с дефисами и косыми чертами на концах);
•	разбиение на предложения и на слова внутри предложений с удалением знаков препинания и построчным представлением результата.
Программы обработки написаны на языках JavaScript (для Windows Scripting Host) и Perl. Разбиение на предложения осуществлялось в предположении, что в исследуемой коллекции используется единственный знак пунктуации для обозначения окончания предложений – точка. Для того, чтобы практически исключить возможное обнаружение точки в позициях, не соответствующих концу предложения, было использовано регулярное выражение:
/\s[а-яА-Я0-9]{2,}\.\s+[А-Я0-9][а-я]/
В процессе работы выяснилось, что аналогичные по функциональности программы, написанные на Perl, работают примерно в 10 раз быстрее, чем написанные на JavaScript.
По каждому документу создавался файл коллокаций, в котором существующие в документе коллокации располагались в алфавитном порядке (по первой, а затем – по второй словоформе коллокации), затем было выполнено многоэтапное слияние этих файлов с уничтожением дублирующих записей о коллокациях. На последнем этапе подсчитывалось количество коллокаций для каждой словоформы – её степень, после чего результирующий файл был отсортирован по степеням словоформ.
4. Результаты
В исследуемой коллекции выявлено 304 749 участвующих в коллокациях словоформ (вершин графа неограниченной сети коллекции) и 4 435 131 различная коллокация (рёбра графа; объём текстового файла со списком коллокаций превышает 85 Мбайт). Как и ожидалось, различные словоформы обладают различной продуктивностью в образовании коллокаций; более всего соседей имеет союз «И» – 47 510.
В соответствии с общепринятой в настоящее время методикой анализа степенных распределений , для определения показателей степени следует использовать так называемое кумулятивное распределение:
P(k) = Σm>k p(m)	(1)
Здесь k и m – ранги вершин в их распределении по степеням:
p(m) – степень (число коллокаций, в которых участвует словоформа) вершины с рангом m;
P(k) – кумулятивная степень (для вершин, с рангом, большим или равным k).
Если распределение – степенное с показателем γ, p(k) ~ k–γ, то P(k) ~ k–(γ–1).
График этого распределения для полученных экспериментальных данных в двойном логарифмическом масштабе (основание логарифма равно 10, так что числа на осях соответствуют степеням 10) приведён в правой части рис. 1. Наглядно видно, что на графике имеется излом, а сам график хорошо приближается двумя ломаными (левая часть рис. 1). Показатели степени, соответствующие этим прямым (для кумулятивного распределения!), равны:
–1.75 – для левой прямой (степени вершин более 500)
–0.95 – для правой прямой (степени вершин менее 500)
 	 
Рис. 1. Кумулятивное распределение степеней вершин словоформ.
Слева – экспериментальные данные, справа – двухстепенное приближение
(для наглядности ломаная линия приближения приподнята)
5. Обсуждение
Полученные результаты достаточно хорошо соответствуют сетевой модели языка, предложенной С. Дороговцевым и Ж. Мендесом. Однако некоторые количественные параметры этой модели в применении к исследованной коллекции заметно отличаются от аналогичных характеристик Британского Национального Корпуса  (см. табл. 1). В исследованной коллекции (сравнимой по объёму с БНК), заметно меньше коллокаций (на 40%), в 4,2 раза ниже максимальная и почти в пять раз ниже средняя степень вершины; в четыре раза меньше степень вершины в точке перехода от ядра к периферии языка коллекции, хотя размер ядра приблизительно тот же.
Таблица 1. Сравнение статистических характеристик
Британского Национального Корпуса и 
коллекции документов российского законодательства («Кодекс»)
Характеристика	БНК	Кодекс
Объём	70 000 000	56 000 000
Вершин (уникальных)	470 000	304 749
Разных коллокаций	17 000 000	4 435 130
Максимальная степень вершины	200 000	47 510
Средняя степень вершины	72	15
γ ядра	–2.70	–2.75
γ периферии	–1,50	–1,95
Степень вершины на переходе от ядра к периферии	около 2 000	около 500
Количество вершин со степенью большей, чем переходная	около 3 000	около 3 000
Напрашивается простое объяснение наблюдаемых отличий – монотематичность исследованной коллекции приводит к уменьшению роли ядра в образовании коллокаций и увеличению роли периферии. Однако, думается, на данном этапе исследований необходимо воздержаться от такого объяснения: возможно, причина в наличии богатого словоизменения в русском языке, и вершиной сети следует считать не словоформу, а лемму. Для обоснованного объяснения отличия наблюдаемых статистических характеристик БНК и коллекции документов российского законодательства необходимы дальнейшие исследования.
Мы планируем такие исследования как на лемматизированной коллекции документов российского законодательства, так и на других коллекциях и корпусах.
Автор признателен М. Губину (компания «Кодекс») за предоставленный текстовый материал, А. Ямсен – за полезные обсуждения.