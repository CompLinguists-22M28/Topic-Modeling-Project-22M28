С.Б.Потемкин
КОРПУС ФОЛЬКЛОРНЫХ ТЕКСТОВ И КЛАСТЕРИЗАЦИЯ УКАЗАТЕЛЕЙ СЮЖЕТОВ 
ведение 
Сказки, как часть фольклора, являются, возможно, самой устойчивой формой сохранения культурной традиции народа. В отличие от подавляющей части достижений ушедших цивилизаций - мифов, утративших силу законов, моральных принципов и технических приспособлений, сказки дошли до нас практически в первоначальном виде. Исследование такого уникального явления как сказка приводит к важным для нашего современника выводам о значимости ее культурного влияния.
В России сказки, собранные выдающимся русским фольклористом Александром Николаевичем Афанасьевым (1826—1871) удивительное и уникальное явление в литературе и шире – в русской культуре Всего для издания было отобрано свыше 600 текстов. Последнее полное издание Сказок вышло в 1984 году. По этому изданию создан электронный ресурс , на основе которого составляется Корпус фольклорных текстов. 
В других странах обширные коллекции народных сказок систематизированы, в частности, ученым из США, Ашлиманом [Ashliman 2004] систематизировавшим более 1000 сюжетов разных народов. Тексты сказок в этом собрании представляют собой скорее синопсис сказки в переводе на английский .
Подготовка фольклорного корпуса сказок Афанасьева
Работа со Сборником включала несколько этапов, как чисто технических, так и требующих привлечения специалистов-филологов или студентов, уже прошедших определенную филологическую подготовку. Вначале каждая сказка была переписана с вышеупомянутого ресурса в отдельный файл в формате UTF8 для сохранения разметки (знаки ударения и пр.). Затем текст каждой сказки был разбит на отдельные словоформы с отделением знаков препинания. Были выделены последовательности, «предложения», оканчивающиеся на знаки: точка, вопросительный и восклицательный знак, а также двоеточие и точка с запятой. Был проведен морфологический анализ каждой словоформы на основе словаря А.А.Зализняка  и частичный синтаксический анализ, включая согласование существительное – прилагательное, предлог – существительное, глагол – существительное и пр. Многие архаичные, диалектные, иноязычные (в основном белорусские и украинские) слова, не найденные в Словаре Зализняка, были выделены в отдельный список, насчитывающий около 4000 словоформ. Этот список с привязкой каждой словоформы к сказке, где она встречается, давался студентам для обработки. 
Указатели фольклорных сюжетов
Фольклорные сюжеты обычно классифицируются по системе, введенной финским исследователем Аарне [Aarne 1910]. По этой системе составлены указатели фольклора разных народов, что автоматически вводит в широкий научный контекст вновь собранный или восстановленный по письменным источникам первичный материал. Система Аарне относит каждую «сказку» к определенному сюжету, без вычленения в ней составляющих сюжетных ходов и обобщения персонажей – если в сказке говорится о черте, его ролевая привязка не может быть заменена на, скажем, колдуна, хотя функции этих персонажей в целом будут совпадать. Каталог Аарне был переведен на многие европейские языки, на русский язык его перевел Н.П.Андреев [Андреев 1929]. В системе Томпсона [Thompson 1973], являющейся развитием системы Аарне, сложные сюжеты разложены на несколько элементов и для каждого элемента приводятся различные реализации. К сожалению, составители наиболее представительного русского указателя сюжетов СУС: [Бараг и др. 1979] воспользовались системой Аарне без томпсоновских дополнений. 
В мировой науке постоянно составляются новые указатели, относящиеся к разным национальным традициям и жанрам. На русском материале существуют указатели различных фольклор-ных жанров том числе электронные, наиболее полным из которых является ресурс . Представляет интерес указатель детских «стра-шилок» . Компьютерная система СКАЗКА [Рафаева 1998], реали-зованная в СУБД Starling, дает возможность отвечать на различ-ные типы запросов относительно волшебных сказок.
Потребность в кластеризации
Построенные указатели основаны на интуиции исследовате-лей и, таким образом, не чужды субъективности. Необходимы формальные методы отнесения того или иного сюжета к той или иной рубрике указателя сюжетов. С этой целью мы применяем методы кластерного анализа и многомерного шкалирования. Для исследования использован ресурс , позволяющий получить более 4000 страниц с описаниями сюжетов и снабженный идентифи-катором сюжета вида andr_87.htm. Была предпринята попытка выделить особые «сказочные» термины, сравнивая частотность лемм в словнике сказочных сюжетов и в частотном словаре об-щей лексики Шарова . Дальнейший анализ проводился только на знаменательных словах, составляющих более половины слово-употреблений. Сюда же можно добавить слова, для которых часть речи не определилась, это скорее всего, редко встречаемые арха-измы и регионализмы. Список наиболее употребительных лексем использовался для определения самых богатых кластеров сюже-тов, напр., кластер, содержащий лексему «Царь» с частотностью 310, должен включать значительно больше элементов, чем кла-стер для слова «Избушка» с частотностью 5. 
Метод последовательного сопоставления
Поскольку сюжет фольклорной сказки развивается последовательно, можно принять в качестве гипотезы, что в паре совпадающих сюжетов последовательности слов также должны совпадать. Для проверки этой гипотезы был составлен алгоритм сопоставления последовательностей, основанный на методе динамического программирования. Среди всех возможных путей от начала до конца предложений алгоритм динамического программирования выбирает тот, который включает наибольшее число совпадающих лексем. Это число и принимается за меру близости двух сюжетов. 
Визуализация взаимного расположения объектов (в нашем случае – сюжетов сказок) на основании меры их сходства/различия позволяет наглядно представить совокупность сюжетов, близких к заданному, а также эвристически выделить кластеры близкорасположенных объектов. Задача визуализации решается методом многомерного шкалирования, применимого в случае, если выборка содержит тысячи объектов, (в нашем случае число пар сюжетов, совпавших хотя бы по одному слову– более 600 тысяч), и, следовательно, пространство объектов существенно многомерно.
Задача многомерного шкалирования (multidimensional scaling, MDS) заключается в отображении пространства большой размерности в пространство меньшей размерности, в частности, размерности 2, что позволяет отобразить выборку в виде множества точек на плоскости (scatter plot). Плоское представление отражает основные структурные особенности многомерной выборки, в частности, семантическое расстояние между сюжетами и кластерную структуру выборки. Поэтому многомерное шкалирование часто используют как инструмент предварительного анализа для понимания данных. Разработанная при участии автора программа [Кедрова, Потемкин, 2007] позволяет построить scatter plot для сильно разреженной матрицы расстояний между сюжетами сказок. На рис. 1 представлена окрестность сюжета А161. Окрестность сюжета «преданная собака» разделилась на 2 кластера, с центрами в точках ANEK886 и A198.  
Рис.1 Центр: 1 - A161 	Преданная собака: незаслуженно наказывается. Кластер А): Баба хуже черта; Кластер Б): Старая хлеб - соль забывается.
Аналогичная методика была применена к сборнику сюжетов Ашлимана. В этом сборнике каждый сюжет описан достаточно пространным текстом, средняя длина которого составляет около 800 слов. Для сравнения в Индексе Андреева (АН) средняя длина описания сюжета сказки составляет около 30 слов. Отсюда для сравнения сюжетов из сборника Ашлимана (АШ) пришлось не ограничиваться последовательным сопоставлением лексем. Мы выделили в текстах сюжетов АШ последовательности глаголов в предположении, что такая последовательность составляет фрейм или структуру сюжета. Структуры сюжетов уже можно сопоставлять последовательно. Для более точного сопоставления сравнивались не сами глаголы V, а их гиперонимы, hyper(V). Полученные результаты (расстояние между сюжетами) подвергались многомерному шкалирования и проецировались на плоскость (Рис. 3)  
Рис. 3 Окрестности сказки Cindarella (Золушка) из собрания Ашлимана
Заключение
Корпус фольклорных текстов позволяет изучать подлинно народный язык конца 19-начала 20 века в исчерпывающем и объективном смысле впервые (чего нельзя сказать о многих, селективных и поэтому субъективных исследованиях). 
В статье также описан новый подход к формированию указателя сказочных сюжетов на основе анализа лексики, определения расстояния между сюжетами и кластеризации сюжетов, которая выполняется путем визуального изучения двумерных образов, полученных методом многомерного шкалирования. Исследование проводилось на материале русских сказок Афанасьева и собрании сказок разных народов Ашлимана в переводах на английский. Результаты исследования могут быть использованы для выявления сходства и кластеризации между однородными объектами при разработке различных онтологий.  

