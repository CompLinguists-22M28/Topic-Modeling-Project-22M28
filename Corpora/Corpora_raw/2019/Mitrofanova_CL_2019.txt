О. А. Митрофанова
ИССЛЕДОВАНИЕ СТРУКТУРНОЙ ОРГАНИЗАЦИИ ХУДОЖЕСТВЕННОГО ПРОИЗВЕДЕНИЯ 
С ПОМОЩЬЮ ТЕМАТИЧЕСКОГО МОДЕЛИРОВАНИЯ: 
ОПЫТ РАБОТЫ С ТЕКСТОМ РОМАНА «МАСТЕР И МАРГАРИТА» М.А. БУЛГАКОВА
1. Постановка проблемы
Фундаментальные принципы исследования сюжета художественного произведения были предложены В.Я. Проппом [Пропп 2001]. Его представление о выводе сюжета волшебной сказки на основе комбинации функций персонажей легло в основу разнообразных логических моделей сюжета. Сюжетные тексты представляют последовательность действий через отношение импликации между категориями сюжета, определяемыми шаблонами поведения персонажей. Это отношение наблюдается в глубинной структуре текста и в ее трансформациях (ср. анализ жанра сказки, басни и т.д.) и может быть объяснено в терминах логического исчисления [Мартемьянов 2004]. С позиций генеративной лингвистики исследование композиции текста можно проводить с помощью сюжетных грамматик, реконструирующих процесс порождения сюжета текста на основе набора правил, описывающих допустимые цепочки микроситуаций [Олкер 1987].
Теоретические модели генерации сюжета получили практическое воплощение в прикладных программах автоматического анализа и генерации сказочных сюжетов [Гаазе-Раппапорт 1980; Рафаева 2014]. Современные исследования сюжета художественных произведений связаны с реконструкцией связей между персонажами с помощью подходов, основанных на правилах (ср. опыт применения правил в Томита-парсере для извлечения фактов об отношениях [Bocharov, Bodrova 2014]) и нейронных сетей [Iyyer et al. 2016]. 
Наряду с этим, есть основания считать, что автоматизированное описание сюжета художественного произведения и его отдельных компонентов возможно с привлечением вероятностного тематического моделирования, процедуры, которая, как правило, применяется в работе с новостными или научными текстами [Blei et al. 2003]. Тем не менее, тематическое моделирование было использовано в ходе анализа англоязычных поэтических текстов [Rhody 2012]; существует опыт построения тематических моделей русскоязычных художественных текстов [Митрофанова 2015; Mitrofanova, Sedova 2017].
В данной работе мы обсуждаем результаты экспериментов по тематическому моделированию текста романа «Мастер и Маргарита» М.А. Булгакова, одного из самых загадочных и противоречивых произведений художественной прозы 20 века. Как известно, роман создавался длительное время, предположительно в период между 1928 и 1940 годами, и за это время сюжет претерпел существенные изменения. Рукопись романа дорабатывалась уже после кончины М.А. Булгакова его вдовой Е.С. Булгаковой и была опубликована лишь в 1966–1967 годах. Особенность данного произведения заключается в том, что это «роман в романе», где противопоставляются два сюжетных плана: с одной стороны, историческое повествование об Иешуа и Понтии Пилате в Ершалаиме (далее роман-Е), с другой – описание разнообразных событий, происходящих с Мастером и Маргаритой, с Воландом и его свитой в современной автору Москве (далее роман-М). В литературной критике признано несколько объяснений композиционной структуры текста (ср. Вулис 1991; Соколов 2006]). Целью нашего исследования является определение соотношения двух сюжетных планов в тексте романа с помощью эмпирического метода, а именно, тематического моделирования. 
2. Исследовательская методика
Тематическое моделирование является одной из стандартных процедур статистического исследования содержательной структуры корпусов текстов [Blei et al. 2003]. Вероятностная тематическая модель соотносит документы корпуса с распределением на множестве тем, а темы – с распределением на множестве слов. Тематическое моделирование представляет собой разновидность нечеткой кластеризации: отдельное слово может быть с разными вероятностями отнесено к нескольким темам, и, аналогичным образом, отдельному тексту может быть поставлено в соответствие несколько тем. В исследовательской практике наиболее распространенена модель LDA (Latent Dirichlet Allocation (латентное размещение Дирихле) [Blei et al. 2003]. Вероятностная модель порождения данных в LDA описывается следующим образом: p(w|d) = Σp(t|d) p(w|t), где p(w|d) – известная частота появления термина w в документе d, p(w|t) – неизвестная вероятность появления термина w в теме t, p(t|d) – неизвестная вероятность появления темы t в документе d. Построить тематическую модель текстовой коллекции D – значит найти множество тем T, распределения p(w|t) для всех тем и p(t|d) для всех документов. Процесс является итеративным и прекращается при достижении сходимости алгоритма.
Для извлечения тем использовалась реализация модели LDA в библиотеке scikit-learn [scikit-learn.org]. Для визуализации результатов тематического моделирования была применена библиотека pyLDAvis [https://github.com/bmabey/pyLDAvis], которая позволяет оценить полученные темы в интерактивном режиме. Текст романа извлечен из Библиотеки М. Мошкова, объем текста составляет ~ 120 тыс. с/у. Непосредственно перед проведением тематического моделирования была проведена предобработка текста, включающая лемматизацию и удаление стоп-слов. Тематическая модель строилась со следующими параметрами: 30 тем, по 30 первых слов в выдаче.
3. Результаты
Эксперименты позволили выявить следующие особенности текста романа «Мастер и Маргарита», отраженные в тематической модели.
1. В модели четко противопоставлены темы, связанные с сюжетами романа-Е и романа-М. Единственная тема, содержащая лексику из глав об Иешуа и Понтии Пилате из романа-Е – это тема 1: прокуратор, Пилат, гость, Иешуа, Ершалаим…(рис. 1). Остальные темы 2…30 связаны с главами, где описываются различные эпизоды, связанные с персонажами из романа-М: ср. тема 4: Варенуха, Римский, финдиректор, кабинет, администратор, Лиходеев…. (рис. 2); тема 9: Маргарита, лететь, Наташа, Луна, река, окно, щетка, боров … (рис. 3) и т.д. В темах есть отдельные «шумы», но их доля не превышает 1% в основной части выдачи (первые 30 слов в теме), ср. тема 1 (бухгалтер и секретарь). Пограничной можно считать тему 3, связанную с фрагментами из последних глав романа.
2. Имена персонажей распределены в темах не случайным образом, а в соответствии с тем, в каких частях романа и в каких внутренних эпизодах они упоминаются. Имя Иешуа присутствует как ядерный элемент в теме 1 для романа-Е (рис. 4), тогда как имя Мастер отражено в темах 2, 3, 5, 9, 10, 11, 14, связанных с главами романа-М (рис. 5).
