А.Ю. Сиротина, Н.В. Лукашевич
ОПЫТ СОЗДАНИЯ КОРПУСА ТЕКСТОВ В СФЕРЕ ИНФОРМАЦИОННОЙ БЕЗОПАСНОСТИ 
1.  Введение 
Для успешного предотвращения утечки и потери данных специалистам в сфере информационной безопасности (ИБ) необходимо максимально быстро получать актуальные сведения о хакерской активности, вирусах и уязвимостях. Одним из наиболее эффективных инструментов сбора этих сведений является система автоматического извлечения информации в данной предметной области. Для обучения и тестирования такой системы необходим размеченный корпус текстов в сфере ИБ. Этот корпус также может быть использован для лингвистического анализа текстов данной предметной области.
Актуальная информация об уязвимостях публикуется на специализированных интернет-ресурсах и форумах в виде неструктурированных текстов. Поэтому наиболее эффективной для сферы ИБ является система, способная извлекать информацию из неструктурированных текстов, и, следовательно, именно такие тексты должны составлять значительную долю от общего объема размеченного корпуса.
2. Обзор близких работ 
Задача разметки корпуса текстов по ИБ рассматривалась в ряде работ. В работе [Bridges et al. 2013] была произведена автоматическая разметка корпуса. Для оценки её качества вручную были размечены несколько десятков текстов. В работах [Weerawardhana et al 2014; Joshi et al. 2013; Lim et al. 2017] рассматривается задача ручной разметки корпуса.
Большинство корпусов данной предметной области (в том числе корпуса, описанные в работах [Weerawardhana et al 2014; Bridges et al. 2013]) содержат частично структурированные тексты: например, бюллетени по безопасности Майкрософт или статьи из Национальной базы данных уязвимостей США (NVD, National Vulnerability Database). В работе [Joshi et al. 2013] корпус включает в себя как частично структурированные, так и неструктурированные тексты, однако доля последних в корпусе крайне мала. Корпус, описанный в работе [Lim et al. 2017], состоит из слабо структурированных формальных текстов – статей и докладов, которые могут содержать различные списки и таблицы.
Общепринятый набор тегов для разметки текстов по ИБ отсутствует, поэтому авторы работ используют различные наборы тегов в зависимости от задач исследования и степени структурированности текстов. В работе [Bridges et al. 2013] в качестве тегов использовались заголовки полей, которые заполняются при описании уязвимости в NVD. Набор тегов в работе [Joshi et al. 2013] был сформирован исследователями в результате анализа текстовой коллекции. В работе [Lim et al. 2017] в качестве источника тегов выступил словарь для описания уязвимостей MAEC . Авторы работ [Joshi et al. 2013; Lim et al. 2017] отмечают, что многие разметчики испытывали трудности при выборе тега.
Во всех упомянутых выше работах описаны корпуса, содержащие тексты на английском языке. Для русского языка, насколько нам известно, размеченные корпуса текстов по ИБ отсутствуют.
3. Исходный корпус и его разметка
В рамках данной работы источником текстов для корпуса послужили публикации и форумы сайта SecurityLab , которые, в отличие от статей из NVD и бюллетеней по безопасности, представляют собой неструктурированные  тексты. В корпус не вошли публикации длиной меньше 500 слов, а также слишком длинные тексты. 
На первом этапе работы была получена частичная автоматическая разметка коллекции. Для этого использовалась система извлечения именованных сущностей (ИС) на русском языке, описанная в работе [Можарова 2017]. В коллекции были автоматически размечены персоны, локации, организации и СМИ (теги Person, Loc, Org и Media соответственно).
Для ручной разметки был сформирован следующий набор тегов: Hacker (отдельные хакеры); Hacker_Group (группы хакеров); Program (программы, в том числе сайты, функции, части программ); Device (электронное оборудование); Tech (технологии, написанные с большой буквы); Virus (зловредное ПО разной природы); Event (различные события и мероприятия).
Тексты размечались четырьмя независимыми разметчиками, при этом не все разметчики являлись специалистами в сфере ИБ. Разметка производилась при помощи онлайн-инструмента для аннотации BRAT .
На данном этапе разметки аннотаторам было дано малое количество указаний о том, как следует размечать ИС различных типов. Предполагалось, что отсутствие изначальной инструкции по разметке позволит выявить наиболее часто встречающиеся ошибки разметки и сформировать в дальнейшем полноценный набор правил для разметчиков.
Всего было размечено 1124 публикаций. В корпус вошли только такие тексты, которые содержат хотя бы один из следующих тегов: Hacker, Hacker_Group, Program, Device, Tech, Virus. В результате объем корпуса составил 861 текст (406488 токенов).
Далее в целях устранения неточностей разметки был произведен вторичный анализ размеченных текстов. В ходе анализа было установлено, что разметчики склонны принимать разные решения при разметке одинаковых контекстов, что привело к большому количеству ошибок и неточностей и общей непоследовательности разметки. Так, например, язык программирования Java в 30 случаях получил неверный тег Program и в 5 случаях – верный тег Tech; аббревиатура СКЗИ (средство криптографической защиты информации) в 13 случаях была неверно размечена как Program, в 43 случаях получила верный тег Tech.
3.1. Примеры непоследовательной разметки
В результате анализа размеченных текстов были выделены случаи непоследовательной разметки, в их числе:
•	Включение или исключение из аннотации парных знаков препинания (скобок или кавычек), окружающих ИС: главный бот-мастер по прозвищу «Netkairo»;
•	Включение или исключение из аннотации русскоязычной части слова с дефисным написанием, где первая часть является ИС: DDoS-атака, Andriod-устройство;
•	Выделение одной или двух ИС в контекстах, где название программы или технологии содержит название разработчика: Apple iOS, Microsoft Internet Explorer 10;
•	Выделение или отсутствие ИС на номерах версий продукта в случае, если они перечислены вслед за названием продукта: Android 7.1, 7.1.1 и 7.1.2;
Кроме того, в текстах были обнаружены определенные типы ИС, выбор тега для которых был затруднен. К таким типам относятся: платежные системы; криптовалюта; языки программирования; команды, методы и классы объектов в различных языках программирования; библиотеки подпрограмм; средства разработки; параметры и факторы; программные ошибки; ссылки и директории. Также разметчики испытывали трудности при выборе тега для ИС с дефисным написанием: Android-устройство (Program или Device), GSM-телефон (Tech или Device).
Вместе с тем были зафиксированы такие группы ИС, выбор тега для которых зависит от контекста:
•	Организация/Локация: Кремль, Белый Дом, Пентагон;
•	Организация/Программа: Яндекс, Google;
•	Программа/Девайс: различные программно-аппаратные средства и комплексы (например, межсетевые экраны);
Такое многообразие неоднозначных и сложных для разметки контекстов делает разметку корпуса текстов в сфере ИБ нетривиальной задачей. Наш опыт показывает, что разметчики, вне зависимости от того, являются ли  они специалистами ИБ или нет, нуждаются в полноценной инструкции, включающей в себя подробное описание используемых тегов и правила выбора тега для ИС различных типов.
4. Новая инструкция и исправление разметки
Во избежание ошибок и неточностей при дальнейшей разметке и при внесении правок в существующую разметку, была разработана новая инструкция, в которой были учтены все сложные и неоднозначные контексты, обнаруженные в ходе анализа размеченных текстов. Так, в рамках новой аннотации были приняты следующие решения:
•	Парные знаки препинания, окружающие ИС, включаются в аннотацию;
•	В аннотацию ИС с дефисным написанием входят обе её части: и предшествующая дефису, и следующая за ним;
•	В контекстах, где название программы или технологии содержит название ее разработчика, последнее не выделяется в качестве отдельной ИС;
•	На версиях продукта, перечисленных после названия продукта, отдельные ИС выделяются, если названия версий содержат буквенные символы: PowerPC G3, G4 и G5;
Для каждого тега в инструкции указаны типы ИС, которым он присваивается. Наиболее актуальна эта мера была для тегов Program, Device и Tech, приписывание которых вызывало больше всего ошибок:
•	Program: операционные системы (iOS 9); браузеры (Google Chrome); скачиваемые и устанавливаемые программы (Adblock); сайты (но не ссылки: SlideShare); файлы и процессы, названия которых записаны в виде «имя.расширение» (Autorun.exe, ipfilter.dat) и пр.;
•	Tech: ряд русскоязычных аббревиатур (СКУД, СЗПДн и пр.); языки программирования (JavaScript); расширения (XML);  протоколы и стандарты (pptp, SSDP);
Для каждого из вышеперечисленных тегов также указываются типы ИС, которым данный тег не присваивается. Так, например, было принято решение не присваивать тег Program: ссылкам и директориям, непрерывным частям кода, ряду аббревиатур (ПО, ОС, СПО и пр.).
В соответствии с новой инструкцией были исправлены ошибки и неточности в разметке корпуса. 
5. Заключение
В данной работе рассмотрена задача создания размеченного корпуса текстов в сфере ИБ. В результате анализа неструктурированных текстов были выделены основные типы ИС, которые встречаются в текстах по ИБ, а также перечислены трудности, которые возникают в ходе разметки. В целях создания последовательной разметки была разработана инструкция, включающая в себя подробное описание тегов и правила выделения и аннотации ИС в неоднозначных контекстах. Корпус текстов был размечен в соответствии с разработанной инструкцией и может быть в дальнейшем использован для обучения и тестирования моделей извлечения ИС в сфере ИБ.
