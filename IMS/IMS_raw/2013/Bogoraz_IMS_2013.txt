Сравнительный анализ методик оценки
межсетевых экранов
А.Г. Богораз, О.Ю. Пескова
Южный федеральный университет
Введение
При современном уровне развития информационно-вычислительных сетей (и зачастую их главенствующей роли в технологической цепочке обработки информации) вопросы обеспечения сетевой
безопасности являются критически важными для
работоспособности всей информационной системы.
Одним из основных средств защиты от внешних
воздействий являются межсетевые экраны (МЭ, в
другой терминологии – файерволы, брандмауэры),
предназначенные для контроля и фильтрации трафика, проходящего через них.
Межсетевые экраны подразделяются на различные типы по своим функциональным возможностям, поддерживаемым протоколам, видам фильтрации и так далее. Но вне зависимости от типа МЭ
существует большое количество программных и
аппаратных решений различных производителей, и
потребителю бывает трудно выбрать систему, наиболее адекватно и эффективно решающие задачи по
защите конкретной сети от несанкционированного
доступа. Информация о межсетевых экранах, доступная непосредственно от производителя, чаще
представляет собой рекламу. Для осознанного выбора желательно получить четкое (стандартизированное) описание качественных характеристик продукта, его достоинств и недостатков, надежности и
уязвимых мест.
На данный момент не существует методологии,
нацеленной именно на специализированное тестирование межсетевых экранов. Для оценки качества
МЭ приходится пользоваться более общими методиками.
Для корректного сравнения методологий следует
понимать, что данные методики рассматривались
только с точки зрения отношения к тестированию
межсетевых экранов.
1. Классификация методик тестирования
защищенности в приложении к
тестированию межсетевых экранов
Классифицируем рассматриваемые методики по
двум типам: методики тестирования информационной безопасности организации и методики проведения тестов на проникновение. Термин «тестирование на проникновение/ прочность» (pentest - «пентест») представляет собой метод оценки безопасности компьютерных систем или сетей средствами
моделирования атаки злоумышленника.
Анализировались следующие методики тестирования информационной безопасности организации:
 OSSTMM – The Open Source Security Testing
Methodology Manual;
 NIST Special Publications 800-115 Technical
Guide to Information Security Testing and Assessment;
 ISSAF — Information System Security Assessment Framework.
Эти методики создавались как методики комплексного тестирования информационной безопасности организации.
Анализировались следующие методики проведения тестов на проникновение:
 методика Positive Technology;
 методика Digital Security;
 BSI — Study A Penetration Testing Model;
 PTES — Penetration Testing Execution Standard — Technical Guidelines.
Данные методики изначально создавались для
проведения корректного тестирования на прочность. Тестирование на проникновение является
одним из главных и важнейших инструментов проверки безопасности. Но в то же время нельзя утверждать, что методики проведения тестов на проникновение описывают только то, что относится к технологии тестирования на прочность, его требованиям, задачам и целям. В зарубежной литературе понятие «пентестинг» является гораздо более широким, чем инструмент для проведения технического
тестирования сети. В случае наших методик, «пентестинг» понимается как комплексная попытка проникновения с задействованием всех возможных уязвимостей, не только технических, но и тех, что относятся к социальной инженерии, и многих других.
Поэтому можно сказать, что сравнение данных
стандартов является вполне корректным, несмотря
на их формально различные классы.
2. Российские методики анализа
защищенности
2.1. Методика Positive Technology
Следует отметить, что российские методики, по
большей части, являются копиями зарубежных методик.
Единственная методика, разработанная в России
— методика Positive Technology [5]. Positive
Technology — одна из ведущих российских компаний в области информационной безопасности. Компания специализируется на комплексном аудите ИБ,
оценке защищенности прикладных систем и вебприложений, тестировании на проникновение и
внедрении процессов мониторинга ИБ.
В качестве целей проведения тестов на проникновение указываются:
 обоснование необходимости проведения
работ по повышению защищенности;
 получение независимой оценки уровня
безопасности информационной системы.
При планировании тестов определяются границы и режимы проведения тестов. Проведение тестов
может быть как с уведомлением персонала объекта,
так и без него.
Достаточно часто в ходе работ, тесты разбиваются на 2 фазы: внешнюю, при которой аудиторы
работают с минимальными знаниями о системе, и
их целью является «пробить периметр», и внутреннюю, когда периметр успешно «пробит», аудиторы
начинают оценку защищенности сети, уже координируя свои действия с администраторами системы.
В компании определены три вида тестов на проникновение:
 технологический;
 социотехнический;
 комплексный.
Для оценки критичности обнаруженных уязвимостей используется методика Common
Vulnerability Scoring System (CVSS), что позволяет
использовать результаты тестирования на проникновение в качественных и количественных методиках анализа риска.
Данную методику можно применять на этапе
оценки продукта для возможности использования
на предприятии.
2.2. Методика Digital Security
Методика Digital Security — методика NSA
INFOSEC, доработанная специалистами фирмы
Digital Security [2]. Компания Digital Security — ведущая российская консалтинговая компания в области аудита ИБ. Модифицированная ее специалистами методика включает в себя этапы:
1. Утверждение с заказчиком режима тестирования. Определяется уровень информированности
исполнителя о тестируемой системе и уровень информированности Заказчика о проведение теста на
проникновение.
2. Подписание договора.
3. Выполнение теста на проникновение. В рамках теста на проникновение аудиторы проводят
полный анализ всех деталей исследуемого объекта,
выбирают подходящие сценарии атак, с учетом человеческого фактора, возможно, разрабатывают
уникальное для каждого конкретного случая программное обеспечение для попытки проникновения
в информационную систему.
Помимо технологических проверок в процессе
внешнего теста на проникновение проводится тестирование возможности проникновения в информационную систему с использованием методик социальной инженерии путем почтовой рассылки на адреса электронной почты пользователей специализированно сформированного сообщения.
По результатам проведения тестирования на
проникновение создается отчет, содержащий детальное описание проведенных работ, все выявленные уязвимости системы и способы их реализации.
Отчет также содержит конкретные рекомендации по
устранению данных уязвимостей.
Данную методику также можно применять на
этапе оценки продукта для возможности использования на предприятии.
3. Зарубежные методики анализа
защищенности
3.1. OSSTMM – The Open Source Security Testing
Methodology Manual [3]
Является достаточно формализованным и хорошо структурированным документом для тестирования сети. Удобен, если необходимо провести полноценную проверку и стандартизацию сети.
Документ имеет так называемую «Карту безопасности» — визуальный показатель безопасности.
На карте указываются основные области безопасности, которые включают в себя наборы элементов,
которые должны быть протестированы на соответствие методике:
1. Информационная безопасность.
2. Тестирование процесса безопасности.
3. Тестирование технологии интернетбезопасности.
4. Тестирование безопасности каналов связи.
5. Тестирование безопасности беспроводных
технологий.
6. Тестирование физической безопасности.
Как таковой, классификации уязвимостей в документе нет, однако указано определение термина
«уязвимость» как ограничения безопасности — это
дефект или ошибка, которая запрещает доступ авторизованным пользователям или процессам к активам, но разрешает привилегированный доступ неавторизованным людям или процессам к активам, или
позволяет прятать активы или скрывать себя же в их
пределах.
В документе присутствует подпункт «Методология»/«Тестирование технологии интернет-безопасности»/«Обзор сети»/«Тестирование МЭ», где перечислена ожидаемая информация, которую может
получить взломщик в результате удачной атаки или
отсутствия нужной функции у средства защиты.
В методике указано, что МЭ должен обладать
конкретными функциями и возможностями, и перечислено свыше 30 типов тестов для их контроля.
Также описываются конкретные корректные реакции сети на атаки и их наличие, например, измерение времени отклика на пакет или проверка наличия
потерь пакетов на маршруте к цели.
Минусами методики считается формализованность и отсутствие дополнительного описания к
требованиям.
Данную методику можно использовать как на
этапе оценки продукта для возможности использования на предприятии, так и на этапе разработки
для проверки отдельных возможностей и функций.
Также методику можно использовать как шаблон
разработки, — какие стандартные функции должны
обязательно присутствовать в конечном продукте.
3.2. NIST Special Publications 800-115 Technical
Guide to Information Security Testing and
Assessment [7, 8]
Создана и поддерживается подразделением NIST
— CSRC, центром по компьютерной безопасности,
объединяющий специалистов федеральных служб,
университетов, крупнейших ИТ-компаний США.
Центр публикует с начала 1990-х годов Стандарты
(FIPS) и более детальные разъяснения/рекомендации (Special Publications) в области информационной безопасности. Рекомендациям (Special Publications), созданным CSRC, присваивается код 800.
В документе присутствуют такие разделы как:
 обзор тестирования и экспертизы безопасности;
 обзор методов;
 определение цели и техники анализа;
 техники оценки уязвимостей цели;
 планирование оценки безопасности;
 выполнение оценки безопасности;
 пост-тестовые мероприятия.
В разделе «Техники оценки уязвимостей цели»,
в качестве одной из техник описываются Тесты на
проникновение, а именно Фазы и Логистика тестов.
По данному документу тесты на проникновение, в
дополнение к стандартным их возможностям, можно применять для определения:
 насколько хорошо система переносит реально существующие модели атак;
 примерного уровня сложности, который
необходимо преодолеть атакующему;
 дополнительных мер противодействия, которые могли бы ослабить угрозы в адрес
системы;
 способности защищающего систему на обнаружение атак и обеспечение соответствующей реакции на них.
Выделяются следующие фазы тестов на проникновение:
1. Планирование.
На данном этапе определяются правила, утверждается и документируется управление, определяются тестируемые цели. Задается основа для успешного тестирования на проникновение.
2. Исследование.
Данный этап включает в себя 2 части.
Первая часть — старт тестирования и сохранение собираемой и сканируемой информации. Для
идентификации потенциальных целей проводится
определение сетевых портов и сервисов.
Вторая часть — анализ уязвимостей. Производится сравнение сервисов, приложений, ОС сканируемого хоста c базами уязвимостей (автоматический процесс для сканеров уязвимостей) и с собственными знаниями аудитора об уязвимостях. Аудитор может использовать свои собственные базы -
или открытые базы уязвимостей — для ручного определения уязвимостей. Ручная обработка позволяет
выявить новые уязвимости, но существенно замедляет процесс.
3. Атака.
Этап проверки ранее определенных уязвимостей
путем их эксплоитирования. Если атака удачна, то
уязвимость проверяется и определяются меры понижения угроз безопасности.
4. Отчет.
Производится во время 3 вышеописанных фаз.
Во время фазы «Планирование» разрабатывается
план оценки. Во время фаз «Исследование» и «Атака» сохраняются записываемые лог-файлы и создаются периодические отчеты для системных администраторов или менеджмента. В заключение теста,
создается отчет, как правило, для описания уязвимостей, указания оценок рисков и представления
указаний по смягчению обнаруженных недостатков.
В главе «Логистика тестов» описываются различные рекомендации по типам тестирования: перед проведением наружного тестирования желательно провести внутреннее, чем отличается внутренне тестирование от наружного, рассматриваются
некоторые организационные моменты тестов.
Также существует отдельный документ, регулирующий методологию работы с МЭ — NIST SP
800—41 Guideline on Firewalls and Firewall Policy. В
пункте «Тесты» документа приводится список аспектов оценки МЭ:
а) Соединения. Пользователи могут устанавливать и поддерживать соединения;
б) Наборы правил, настройка разрешений и запретов на передвижение трафика по сети;
в) Совместимость приложений. МЭ не мешают
стандартной работе приложений;
г) Менеджмент. Администратор может конфигурировать и управлять МЭ эффективно и безопасно;
д) Журналирование. Журналирование и функции
управление данными настраиваются в соответствие
с политикой и стратегией организации;
е) Производительность. МЭ должен обеспечивать адекватную производительность при нормальной и пиковой нагрузках;
ж) Безопасность выполнения. МЭ может содержать уязвимости, которыми может воспользоваться
атакующий;
и) Взаимодействие компонентов. Компоненты
МЭ должны работать вместе должным образом;
к) Синхронизация политик. При большом количестве запущенных МЭ запускающих синхронизированные политики или группы правил, необходимо
тестировать синхронизацию при различных сценариях;
л) Дополнительные возможности. Также должны
быть протестированы для утверждения их корректной работы.
Данную методику можно использовать как на
этапе оценки продукта для возможности использования на предприятии, так и на этапе разработки
для проверки отдельных возможностей и функций.
Также методику можно использовать как шаблон
разработки — какие стандартные функции должны
обязательно присутствовать в конечном продукте..
3.3. BSI — Study A Penetration Testing Model [1]
Разработан германским подразделением «Federal
Office for Information Security».
В документе описывается проведение корректных испытаний системы на прочность. Подробно
описываются не только сама методология тестов, но
и необходимые требования, правовые аспекты применения методологии и процедуры, которые необходимо выполнить для успешного проведения тестов. Присутствуют такие разделы, как:
 введение и объекты обучения;
 it-безопасность и тесты на проникновение;
 классификация и объекты тестов на проникновение;
 правовые вопросы;
 общие требования;
 методология тестов на проникновение;
 выполнение тестов на проникновение.
Согласно этому документу, существует 3 типа
методов, с помощью которых можно нанести ITсистеме вред или подготовить атаку:
 атаки через сеть;
 социальная инженерия;
 обход физических мер безопасности.
Определены 5 процедур, которые необходимо
выполнить для проведения тестов на прочность:
 поиск информации о целевой системе;
 сканирование целевой системы на предмет
наличия сервисов;
 идентификация системы и приложений;
 исследование уязвимостей;
 эксплоитирование уязвимостей.
Приводится классификация тестов на прочность
и определены ее критерии.
Документ также описывает пять фаз тестов на
прочность:
1. Подготовка
С помощью клиента определяются объекты тестирования. Тесты должны выполняться с учетом
всех правовых аспектов. Аудитор должен быть уверен, что тесты не нарушают каких—либо законов
или договорных обязательств. Процедура и ее риски
должны быть обсуждены и задокументированы.
2. Разведка
После первой фазы, аудитор может начинать собирать информацию о цели. Это фаза пассивного
тестирования на прочность. Цель — получить полный и детальный обзор установленных систем,
включая области открытые для атак и известные
недостатки безопасности.
3. Анализ информации и рисков.
Для успешной, прозрачной и экономически эффективной процедуры, собранная информация
должна быть проанализирована перед началом активного тестирования на проникновение. Анализ
должен включать в себя определение целей тестов
на проникновение, потенциальные риски системы и
время, необходимое для оценки возможных проблем безопасности для последующих активных тестов.
4. Попытки активного вторжения.
Данная фаза влечет высокий уровень риска и
должна проводиться с должным вниманием. Однако, только эта фаза может показать, какова опасность предполагаемых уязвимостей, выявленных в
ходе разведывательной фазы.
5. Окончательный анализ.
Конечный отчет должен содержать оценку уязвимостей в виде форм потенциальных рисков и рекомендации устранения уязвимостей и рисков. Отчет также должен гарантировать прозрачность тестов и раскрытие уязвимостей.
6. Документирование. Во время всех вышеописанных фаз происходит журналирование, запись,
обработка и выработка рекомендаций.
В приложениях содержатся описание ПО, которое можно использовать для тестирования объектов,
описанных в методике.
Данную методику рекомендуется использовать
для тестирования конечного продукта. Она является
достаточно подробной и старается предусмотреть
все аспекты тестов на прочность, как технические,
организационные, так и правовые.
3.4. ISSAF — Information System Security
Assessment Framework [6]
Разработан Open Information Systems Security
Group — OISSG для следующих инструментов менеджмента и внутренних контрольных проверок:
а) Оценка политик и процедур информационной
безопасности организации для отчетности об их
соответствии индустриальным IT—стандартам,
применимым законам, а также нормативным требованиям;
б) Выявление и оценка зависимости бизнеса от
инфраструктуры IT-услуг;
в) Проведение оценки уязвимостей и тестов на
проникновение для выделения уязвимостей в системе, которые могут привести к потенциальным
рискам информационных активов;
г) Указание моделей оценки по доменам безопасности;
д) Нахождение и устранение неправильных конфигураций;
е) Идентификация и решение рисков, связанных
с технологиями;
ж) Идентификация и решение рисков, связанных
с персоналом или бизнес-процессами;
з) Усиление существующих процессов и технологий;
и) Предоставление лучших практик и процедур
для поддержки инициатив непрерывности бизнеса.
Документ охватывает огромное количество вопросов, связанных с информационной безопасностью. Присутствуют главы, описывающие оценку
безопасности МЭ, роутеров, антивирусных систем и
много другого.
В главе «Методология тестов на проникновение»
представлены 3 фазы, которые необходимо осуществить для корректного проведения тестов на проникновение:
1. Планирование и подготовка.
Получение начальной информации, планирование и подготовка к тестам. Перед тестированием
сторонам необходимо будет подписать формальное
соглашение, которое обеспечит основу для задания
и взаимную правовую защиту. В нем также будет
указаны взаимодействующие команды, точные даты, время тестирования, пути эскалации и другие
мероприятия.
2. Оценка.
На этом этапе производится выполнение тестирования на проникновение. Предусмотрены следующие девять уровней:
1). Сбор информации.
Для сбора информации в основном используется
Интернет. Получаемая информация делится на 2
группы: техническая (DNS/WHOIS) и нетехническая (поисковые системы, группы новостей и т.д.).
На данном этапе абсолютно любая информация является полезной: брошюры компаний, визитные
карты, объявления в газетах и т.п. Данный этап критичен, так как позволяет выделить точек, которые
могут быть уязвимы, и сфокусироваться на них.
2). Сетевое картографирование.
После сбора информации в интернете о целевом
объекте применяется более технические подходы к
определению сети и ее ресурсов. Информация о
сети, полученная на первом уровне, используется
для расширения знания о возможной топологии сети целевого объекта.
3). Идентификация уязвимостей.
Перед этой стадией, аудитор определяют объекты и способы тестирования. В процессе тестирования аудитор будет выполнять следующие мероприятия:
a) Идентификация уязвимостей сервисов с
помощью определения реакции почтовых
сервисов.
b) Выполнение сканирования на предмет поиска известных уязвимостей. Информация
об известных уязвимостях берется из открытых баз данных уязвимостей.
c) Выполнение ложной позитивной и ложной
негативной проверок (например, сопоставляя уязвимости друг с другом и с ранее полученной информацией).
d) Подсчет обнаруженных уязвимостей.
e) Оценка возможного воздействия (классификация найденных уязвимостей).
f) Идентификация путей атак и сценариев
эксплоитирования.
В документе определяется 2 типа рисков: Технический риск и риск Бизнеса. В свою очередь каждый
из них делится на 3 вида: Низкий, Средний, Высокий.
4). Проникновение;
5). Получение доступа или расширение привилегий;
Получение минимальных привилегий доступа
возможно через доступ к непривилегированным
аккаунтам с помощью следующих способов:
a) Подбор комбинаций логин/пароль
(bruteforce, атака со словарем);
b) Поиск пустых или стандартных паролей в
системных аккаунтах;
c) Эксплоитирование стандартных настроек
поставщика (параметры конфигурации сети,
стандартные пароли и т.д.);
d) Поиск публичных сервисов, допускающих
определенные операции в системе (запись/создание/чтение файлов).
Конечной целью аудитора является получение
доступа к аккаунту Администратора.
Часто в системах разрешены только аккаунты с
минимальным количеством привилегий. В этом
случае выполняется составление карты локальных
уязвимостей, производится разработка или получение корректного эксплоита, затем он тестируется в
изолированной среде и применяется к компроментированной системе.
6). Дополнительные тесты, например, получение
зашифрованных паролей для их последующего оффлайнового взлома, сниффинг трафика и его анализ
и т.д.
7). Компроментация удаленных пользователей/сайтов;
8). Поддержка доступа;
9). Скрытие следов.
Также присутствует глава «Оценка безопасности МЭ», где описывается, какие бывают МЭ, каким
функциями они должны обладать и защиту от чего
они не могут предоставить.
Непосредственно методология включает в себя 4
этапа:
1) Определение МЭ:
2) Определение общих неправильных конфигураций:
3) Тестирование общих атак на МЭ:
4) Тестирование продукта по специфическим вопросам.
Также в главе прилагается подробные рекомендации по тестированию. Описаны не только утилиты, которыми можно провести тестирование, но и
указания по их использованию и какие реакции
можно получить в результате тестирования с определенными параметрами.
Данную методику рекомендуется применять для
проверки конечного продукта или проверки общей
надежности сети.
3.5. PTES — Penetration Testing Execution
Standard — Technical Guidelines [4]
Стандарт, разработанный для объединения как
бизнес требований, так и возможностей служб безопасности, и масштабирования тестов на проникновение. На первом подготовительном этапе подробно
рассматриваются устанавливаемые каналы коммуникаций, правила взаимодействия и контроля, конкретные способы реагирования и мониторинга инцидентов.
Далее выделены следующие этапы:
1. Сбор информации
2. Моделирование угроз
3. Методы анализа уязвимостей
4. Эксплоитация — обеспечение обхода контрмер и обнаружение наилучшего пути атаки
5. Пост-эксплоитация — анализ инфраструктуры, последующее проникновение в инфраструктуру,
зачистка и живучесть.
Определена структура отчетов, составляемых по
результатам тестирования.
4. Результаты сравнения методик
В целом, результаты сравнения методологий по
фазам тестов на прочность можно проиллюстрировать следующей картой (рис.1)
В таблице 1 приведено сравнение методик по
подробности описания пунктов. Для этого возьмем
подпункты, предлагаемые всеми методиками, и рассмотрим, насколько подробно они упоминаются в
каждой методике с помощью системы бальных оценок от 0 до 10. Пункты будут разделяться на 3 стандартных фазы: Подготовка, Выполнение тестов и
Создание отчета.
В таблице 2 приведено сравнение методик по
определенным критериям с помощью аналогичной
системы бальных оценок от 0 до 10.
По результатам анализа данных методик была
предложена авторская методика тестирования, назначением которой является оценка уровня защиты,
предоставляемой межсетевым экраном. Методика
предназначена для стендового тестирования, однако, может использоваться для тестирования в рабочей системе заказчика