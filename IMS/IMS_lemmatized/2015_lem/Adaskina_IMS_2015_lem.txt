метод полуавтоматический классификация для дать с несбалансированный класс ю.в. адаскина1, а.м. попов1,2, п.в. реброва1,2 1 infoqubes 2 санкт-петербургский государственный университет 1. введение автоматический классификация текст при помощь метод машинный обучение являться один из самый востребовать задача прикладной лингвистика в последний время. для настройка модель с изначально задать класс необходимо вручную разметить небольшой фрагмент выборка документ и на они обучить классификатор. далее выявить автоматически характеристика категория быть применить к новый документам. существовать много разновидность задача классификация (иерархический классификация, классификация, допускать пересечение классов, классификация с ранжирование и др.), однако ключевой момент для работа весь подобный алгоритм являться наличие качественный тренировочный данных, получение который зачастую представлять себя отдельный сложный задачу. мы работать над коммерческий проектом, в основа который лежать классификатор на ключевой словах. подбор ключевой слово для каждый из категорий, включая категория «спам», заниматься эксперт. особенность это проект состоять в том, что класс нерелевантный документов, который необходимо отсеивать аналитику, не иметь чёткий критериев. это, а также больший объём поступать на вход документ делать он работа очень кропотливый и трудоемкой, поэтому перед мы встать задача снижение трудозатрата эксперт в работа над улучшение качество классификатора. замена такой классификатор на автоматический казаться логичный шагом, однако в наш случай класс релевантный и нерелевантный документ не сбалансированы, и для получение репрезентативный выборка прийтись бы просматривать и размечать большой количество текстов. поэтому для снижение трудозатрата эксперт мы применить полуавтоматический метод классификации. за основа быть взять алгоритм пополнение семантический классов, разработать мы в [1]. метод в исходный вид предназначаться для сокращение трудозатрата эксперта, заниматься подбор лексики. он предполагать обучение с частичный привлечение учитель (bootstrapping), то есть итеративный применение алгоритм машинный обучение с корректировка модель на каждый шаг на основа вновь получить данных. в результат для того, чтобы получить достаточно полный словарь термин персонал из корпус объём в 580 000 слов, достаточно быть взять два исходный частотный термин и итеративный просмотреть в общий сложность около 1000 слов, постепенно корректировать классификатор. соответственно, для решение задача классификация на основа это метод мы предлагать алгоритм с автоматический ранжирование список документ по вероятность они принадлежность к тот или иной классу. мы предполагаем, что такой образ возможно построение качественный классификации, и при это трудозатрата эксперт быть минимизированы. раздел 2 наш статья посвятить теоретический предпосылка исследование и краткий описание работа в этот области. в раздел 3 изложить основный гипотеза, а раздел 4 описывать наш эксперимент для она проверки. в раздел 5 обсуждаться вывод и идея для дальнейший работы. 2. предпосылка всё работа по классификация текст так или иначе связать с [2], посвятить категоризация текст на основа вероятностей, обзор основный метод решение задача классификация представить в работа [3]. классификация текст применяться к широкий спектр практический задач, например, таких, как каталогизирование новостной статей, классифицирование веб-страниц, автоматический классифицирование письмо электронный почта по они содержанию. очень часто для такой задача использоваться наивный байесовский классификатор, метод опорный векторов, использование максимальный энтропии. 17 в [4] рассматриваться проблема автоматический классификация документ с использование машинный обучения, в рамка который нужно выявлять документы, релевантный для определённый категории. метод обучение с частичный привлечение учитель успешно применяться для задач, где получение разметить тренировочный корпус достаточный объём затруднить или невозможно: см., к примеру, [5] для задача пополнение лексический классов, [6] и [7] – для выявление именовать сущностей, [8], [9] и [10] – для классификация текстов. как показать в [1], наш алгоритм позволить достигнуть приемлемый качество анализ небольшой специализировать корпуса, состоять из предварительно не очистить данных, различный по они отношение к тематика рассматривать семантический класса. в работа [11] показано, что метод обучение с частичный привлечение учитель хорошо справляться с задача повышение точность классификации, особенно в тот случаях, когда разметить весь несколько документов. мы развить этот идею, задействовать итеративный алгоритм дообучение с использование вновь разметить документов. в [12] предлагаться метод ранжирование документ по вероятность принадлежность к определённый класс – так называть оценка доверие (confidence estimate), то есть числовой значение, который показывает, насколько верный являться принятие решение о принадлежность документ к один из классов, а также предлагаться мера оценка подобный метод ранжирования. использование ранжирование облегчать задача экспертный верификация автоматический классификации. то есть после того, как алгоритм классификация отработал, эксперт предоставляться список классифицировать документов, отсортировать по вероятность они принадлежность к приписать классу. этот метод применимый не только к область классификация текстов. он быть полезный для любой задача классификации, в который присутствовать несбалансированность классов. мы использовать этот подход вместе с итеративный алгоритмом, что позволить всё более эффективно размечать новый документ на каждый следующий итерации. большинство алгоритм обучения, применять для задача классификация текстов, по слово авторов, основываться на представление документ в вид «мешок слов», однако в работа [13] описываться использование синтаксический информация в качество параметр для классификации. в данный эксперимент в качество входной информация использоваться лингвистический модель словосочетаний, то есть тот информация, который и быть извлекаться из тренировочный корпуса. затем применяться синтаксический эвристика для создание лингвистический моделей, который смочь извлечь нужный информация из тренировочный и из неизвестный документов. извлекаться модель следующий типа: subject-verb или verb-direct-object, или предложный группы. обучение и классификация производиться при помощь наивный байесовский классификатор и алгоритма, основать на правилах. оцениваться три вариант сочетание параметров: − только слова; − только словосочетания; − и слова, и словосочетания. 18 эксперимент показал, что использование лингвистический параметр улучшать точность классификация текст на нижний граница полноты. тем не менее, улучшить точность классификатор на высокий уровень полнота не удалось, по мнение авторов, из-за того, что параметр словосочетание обычно сфокусировать очень узко. мы решить задействовать иметься у мы синтаксический анализатор на правило для получение синтаксический информация о документах, предполагая, что использование синтаксический информация в качество параметр для итеративный алгоритм позволить повысить качество работа алгоритма. 3. гипотеза основный предположение состоять в том, что наш алгоритм обучение с частичный привлечение учитель позволить существенно снизить трудозатрата эксперт путём уменьшение необходимый для просмотр количество документ в процесс настройка классификатора. в основа метод лежать итеративный алгоритм. идея состоять в том, чтобы эксперт на каждый итерация размечать небольшой фрагмент выборка весь выборка (несколько процентов), после что происходить бы обучение классификатор с последующий сортировка выборка по убывание вероятность принадлежность документ к целевой классу. предполагается, что за несколько итерация подавлять большинство релевантный документ оказаться вверху сортировать выборки, при это число весь разметить эксперт документ быть в несколько раз маленький объём выборки. применительно к задача классификация мы предполагаем, что на нулевой шаг эксперт самостоятельно размечать небольшой подмножество исходный выборки, в наш случай быть использовать 40–50 документов, что составлять 7–8% весь выборки. затем классификатор произвести обучение на данный фрагмент выборка и отсортировать весь выборка по вероятность принадлежность к целевой классу. после что эксперт получать список неразмеченный они документов, отсортировать по вероятность они попадание в класс нерелевантных. на следующий итерация эксперт необходимо быть разметить ещё некоторый количество документ (в наш случай ещё 40–50), просматривать отсортировать список сверху вниз, после что обучение и сортировка повторяются. мы предполагаем, что такой модель дать приемлемый результат классификация уже при просмотр небольшой число документ эксперт (в несколько раз маленький объём выборки). пользователь система мочь варьировать число итерация и число просмотреть на каждый шаг документ в зависимость от желаемый критерий качество и наличие времени. критерий качество в данный случай мы считать полнота классификации, а также коэффициент эффективности, под который мы понимать отношение число просмотреть документ к общий объём документов. коэффициент эффективность метод – отношение полнота классификация к объём просмотреть документов, то есть мера, соответствовать тому, сколько 19 процент полнота приходиться на каждый процент просмотреть при использование данный метод документов. 4. эксперимент для наш эксперимент быть взять множество из 620 документов, представлять себя отзыв клиент международный ритейл-сети. после процедура дедупликация остаться 546 уникальный документов. дать документ быть обработать наш система лингвистический анализа, который привести словоформа к нормальный форма и расставить синтаксический связь между словами. далее каждый документ при помощь специально разработать для этот задача инструмент быть представить как неупорядоченный множество параметров, весь мы использовать параметр три видов: нормальный форма (униграммы), два подряд идти нормальный форма (биграммы) и синтаксический связь (два нормальный форма связанный друг с друг слово и тип отношение между ними). мы решить проверить эффективность совместный использование несколько вид параметр в весь возможный комбинация (комбинация привести с условный обозначениями, использоваться ниже в результат эксперимента): − l – только лемма (униграммы); − b – только биграммы; − r – только синтаксический связи; − lb – лемма и биграммы; − lr – лемма и синтаксический связи; − br – биграмм и синтаксический связи; − lbr – леммы, биграмм и синтаксический связи. выборка содержать около 10% нерелевантный документов, который мы для простота быть называть «спамом». до начало эксперимент всё документ из категория «спам» быть вручную разметить экспертом. далее сам эксперимент проводиться автоматически, при помощь специально написать скрипта, который имитировать действие эксперта. на первый итерация скрипт «размечал» n документ из выборка в соответствие с разметкой, предоставить экспертом, после что проводить обучение на получить разметке. далее на каждый из последующий итерация скрипт доразмечать ещё n документов, находиться вверху сортировать выборка в добавление к уже разметить ранее документам. на каждый итерация в лог записываться текущий показатель полнота и эффективности. эксперимент продолжаться до тот пор, пока всё документ не оказываться «просмотренными» программно. каждый эксперимент проводиться для различный шаг n (число просматривать на каждый итерация документов). число n варьировать от 20 до 50 с шаг в 15 документов. мы использовать классификатор на опорный вектор с линейный ядро linearsvc из библиотека sklearn для язык python (см. [14]). при помощь данный классификатор производиться двухклассовый обучение на весь разметить на текущий итерация документах, после что быть получить вес принадлежность к целевой класс «спам» при помощь функция «decision_function» и сортировка выборка по убывание данный показателя. результат собрать в несколько таблица и представить ниже. в весь таблица и график использоваться условный обозначения, перечисленный в описание параметров. в столбец «выборка» указываться отношение просмотреть документ на каждый итерация к объём весь выборки. из этот таблица видно, что для некоторый комбинация параметр удаваться добиться очень высокий полнота уже на небольшой число итераций, при просмотр небольшой фрагмент выборки. в частности, наиболее эффективный оказываться параметры: биграмм (b), связь (r), связь и биграмм (br), который позволять получить полнота в диапазон 0,87-0,91 при просмотр менее четверть весь выборки, то есть экономия время эксперт составить бы более четыре раз. на графика ниже привести зависимость полнота классификация от доля просмотреть выборка для наиболее эффективный параметр (b, r и br) вместе с результат для только лемма (l) и общий сочетание весь три вид параметр (lbr). график наглядно демонстрирует, что, как самостоятельный эффективность лемм, так и сочетание лемма с другой параметрами, давать существенно более низкий показатели. в таблица 2 привести аналогичный результат для выборка с шаг 35. видно, что увеличение шаг просмотр не сказываться положительно на эффективность работы: чуть-чуть более низкий полнота, в диапазон 0,81-0,87, достигаться при чуть более низкий доля просмотреть документов, а такой же полнота, в диапазон 0,87-0,91 достигаться более высокий доля просмотреть документов, чем при шаг 20. для наглядность привести также таблица 3 с шаг в 50, чтобы продемонстрировать ещё больший снижение эффективности. наглядно результат сравнение эффективность между размер шаг представить на рис. 2. на графика показать зависимость полнота от доля просмотреть документ для параметр связь с шаг 20 (r 20) и связь с шаг 50 (r 50), а также аналогично для комбинация биграмм и связь в качество параметр с шаг 20 (br 20) и с шаг 50 (br 50). из графика видно, что практически на весь протяжение кривых, кривая показывать зависимость на больший шаге, проходить ниже и правый кривых, показывать зависимость на малый шаге, что наглядно демонстрировать преимущество использование малый шага. 5. заключение получить результат подтверждать наш гипотеза о том, что данный метод, опробовать мы на задача пополнение семантический классов, применимый также к задача классификация документов, когда составление тренировочный корпус достаточный объём затруднено. в качество параметр классификатор мы брать различный комбинация из лемм, биграмм и синтаксический связей; хороший результат классификатор показать при использование синтаксический связь изолированно, а также синтаксический связь с биграммами. оптимальный прогон позволять получить полнота классификация 0,91 уже при просмотр 24% документов, то есть коэффициент эффективность метод (отношение полнота классификация к объём просмотреть документов) в такой случай составлять 3,79. эксперимент показал, что выбирать набор параметр для классификация мочь оказывать существенный влияние на качественный показатели, как и размер шага. выбор размер шаг зависеть от иметься у эксперт время и желательный полноты, однако алгоритм с малый шаг давать бόльшуя эффективность. что касаться набор параметров, лемма в качество параметр классификация существенно снижать эффективность алгоритм как изолированно, так и в комбинация с биграмм и синтаксический связями. для дальнейший исследование в качество параметр предлагаться использовать также семантический теги. кроме того, представлять интерес проверка работа это алгоритм на другой дать и для другой тип классификации: например, для классификация с больший число класс возможно последовательный применение наш метода, если число документ из этот класс сильно маленький общий объём выборки.