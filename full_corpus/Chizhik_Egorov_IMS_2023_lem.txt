поддержка модель превентивный медицины: модуль обработка естественный язык для дистанционный взаимодействие «клиника-пациент» а.в. чижик1,2, м.п. егоров 1, м.ю. якубова1, д.а. погребной1, а.с. кривошапкина1 1. введение здоровье население являться один из факторов, влиять на полюс, к который стремиться социальный настроение, и с этот позиция оно являться достаточно сложный феноменом, определяться через взаимодействие социальных, психологических, экономический и только затем биологических, генетический и физиологический факторов. иной словами, в многое уровень здоровье население зависеть от мировоззренческий контекста, присутствовать в общество и способствовать выстраивание постоянный и доверительный коммуникация с медицинский учреждениями. предпосылка для проведение это исследование стать опыт создание мультимодальный интеллектуальный помощник для автоматизация процесс приём пациент и оказание первичный медицинский помощи. система здравоохранение в весь мир использовать автоматизация для решение проблема нехватка персонала, а также для эффективный управление и сортировка пациент в больший масштаб в больница и клиниках. один из вид автоматизация являться чат-бот и сопутствовать технологии, позволять автоматизировать процесс первичный общение с потенциальный пациент (включать фиксация симптом на сторона клиника и предоставление человек необходимый справочный информации). это позволять преодолеть географический и временной барьер между служба здравоохранение и они пользователями. такой образом, конечный цель этот усилие являться переход от неотложный помощь к профилактической, что возможно только на основа управление взаимодействие на основа данных. важно отметить, что есть новый социологический исследования, который показывать тенденцию: каждый пятый врач покидать профессия в течение два год по причина профессиональный выгорания, что объясняться больший количество рутинный деятельность (преимущественно офисный характера) [1, 2]. чат-бот мочь облегчить нагрузка на врачей, медсестра и другой медицинский работников, автоматизировать задачи, который хороший подходить для компьютера, и в результат освобождать медицинский бригада для более продуктивный выполнение свой основной работы. провести серия эксперимент по создание чат-бот с открытый домен для общение пациент с клиникой, мы поняли, что невозможно создать полностью универсальный диалоговый агент, который любой клиника мочь бы запустить в работа без дополнительный усилий. в то же время стать понятно, что клиника нужный готовый модули, из который можно быть бы собрать нужный функциональный конфигурация диалоговый агент непосредственно на сторона клиники. поэтому мы решить создать библиотека для язык python, который мочь бы: ₋ обнаружить симптом в реплика пользователь (на вход языковой модель получать короткий текст на ея, содержать ответ с сторона пользователь на вопрос бот порядок «описать свой самочувствие»); ₋ использовать этот информация для вынесение интерпретировать суждение о возможный диагноз (т.е. диагноз и сопроводительный информация о вероятностный распределение – концепция «второе мнения»); ₋ присвоить пациент метка срочность (мультиклассификация пациент для распределение поток пациент в клинике). на рис. 1 показать логика разработать модуля. рис. 1. блок-схема разрабатывать модуль в рамка поднимать проблема актуальный являться исследования, посвятить метод обработка и понимание естественный язык (nlp, natural language processing и nlu, natural language understanding). при разработка диалоговый агент обычно решаться следующий классический задача обработка естественный языка: сегментация, токенизация и лемматизация, ner и нахождение семантический связь [2]. существовать и специфический задача [3]: обработка последовательность из несколько фраз, дополнять друг друга; поиск ссылка с один фраза на другую; обработка чередование разный тип интент подряд; генерация уточнять вопрос и они обработка. в наш исследование мы в первый очередь сосредоточиться на проблема выявление симптом (и они отрицания) и последующий использование этот информация для определение диагноз [4, 5]. следовать отметить, что задача создание специализировать языковой модель являться достаточно динамично развивающейся, в частности, можно упомянуть следующий два современный исследование (относиться к область медицины) [6, 7, 8], подход который заключаться в использование условно закрытый дать (электронный медицинский карта пациентов, эмк). 2. дать ролевый модель дистанционный взаимодействие между клиника и пациент подразумевает, что диалог строиться в формат разговорный русский языка, свойственный социальный сеть (так как сам интерфейс любой диалоговый агент напоминать месседжер). такой образом, при формирование набор текстовый дать необходимо стремиться к близость собирать реплика к язык пациентов, а не к служебный язык медиков. поэтому мы решить отойти от общий тенденция использование при разработка подобный модуль текстовый данных, взять из эмк (анамнез и диагнозы) и собрать дать из открытый веб-источников: ₋ основа набор дать – 5 193 описание пациент свой заболевание с маркёр категория болезнь (источник: https://meduniver.com); ₋ датасет дополнить 292 заболевание с они описание (источник: https://health.mail.ru/disease/adneksit/); ₋ также быть собрать дать о симптом из википедия (272 симптома). рис. 2. распределение категория болезнь на рис. 2 показать распределение заболевание по медицинский категориям. в ход анализ данных, быть выяснено, что в средний пациент упоминать 2-3 симптома, присутствовать в он самочувствии, и тратить на описание около 66 слов. 3. метод на рис. 3 показать логика взаимодействие с текстовый данными, который мы придерживаться при разработка данный модуля. быть решить разработать система подмодулей, что должный обеспечить возможность использовать библиотека не только в полный функционале, но и частично, например, только для выделение симптомов. рис. 3. пайплайна обработка и классификация медицинский текстов: текущий реализация процесс предобработка дать в рамка наш проект практически ничто не отличаться от стандартный набор процедур, однако в отличие от классический подход к этот этапу, мы решить сохранять некоторый стоп-слова, чтобы не потерять отрицание симптом (исходить из того, что отрицание симптом тоже являться симптомом). далее мы потребоваться список симптом для они последующий извлечение из текстов. хотя существовать методология детекции ключевой слов, который можно применить, в наш случай они оказаться не очень полезными. поэтому быть использовать готовый список симптом из открытый база знание «википедия». далее для формирование необходимый информация мы использовать фреймворк scapy. он мочь извлекать необходимый объект из текста, использовать предварительно обученный модель машинный обучения. мl-модель, доступный в фреймворк по умолчанию, не смочь справиться с большинство симптомов. поэтому быть создать некоторый набор правил-подсказок, чтобы помочь модели. каждый такой подсказка – паттерн, написать отдельно для каждый симптома. как уже быть отметить выше, также перед мы стоять задача детектирование отрицание симптомов. для этот цель мы использовать пакет python negex, который работать с весь найти сущность и пытаться найти отрицание для каждый из они (этый реализоваться за счёт определение граница часть предложение и поиск в этот граница специальный слово и другой признаков, полезный для задача поиск отрицания). после этот два шаг у мы появиться общий анамнез, сформировать на основание дать основный датасета, который включить всё возможный симптом с статус (yes, no, no_info, confused). диаграмма это процесс представить на рис. 4. рис. 4. логика формирование набор симптом с статус в момент взаимодействие с реплика пользователь появляться задача мультиклассовый классификации, который в наш модуль решаться с помощь модель логистический регрессии. отметим, что логистический регрессия – это статистический модель, который использоваться для прогнозирование вероятность возникновение некоторый события, в данный случай для диагностика конкретный заболевания. модель применяться к подготовить дать и подразумевать создание матрица признаков, в который каждый столбец представлять определённый симптом, а каждый строка представлять конкретный случай пациента. значение в ячейка матрица указывать на наличие (1), отсутствие (0) или отрицание (-1) симптома. использовать подготовить матрица признак и соответствовать метка класс (заболеваний), модель логистический регрессия обучается. в процесс обучение модель определять оптимальный вес для каждый признак (симптома), который позволять наиболее точно классифицировать заболевания. преимущество логистический регрессия являться интерпретируемость результатов. веса, присвоить каждый симптому, отражать важность это симптом в определение заболевания. такой образом, врач и другой медицинский работник мочь анализировать этот вес и понимать логика результат модели. более того, логистический регрессия учитывать наличие, отсутствие и отрицание симптомов, что делать результат ещё более точный и надежными. из вышеизложенный ясно, что мы становиться легко получить удобочитаемый интерпретация диагноз пациента. текущий точность модель составлять 86%. можно обозначить конечный цель наш модуль определение срочность приема/госпитализация пациента. система здравоохранение в россия предполагать 3 форма помощи: экстренную, срочный и плановую. поэтому, чтобы разметить дать по срочности, мы собрать симптом из различный открытый источник по категория экстренных, срочный и плановый приемов. для тестирование точность наш модель машинный обучение мы сосредоточиться на заболевание из категория «кардиология». разметить на три класс срочность симптом быть верифицировать на предмет применимость к задача кардиолог национальный медицинский исследовательский центр им. в.а. алмазова. отметим, при отнесение случай к первый два категория (экстренный и срочный прием) пациент требоваться госпитализация, поэтому быть принять решение маркировать дать бинарно: госпитализация требоваться или не требуется. рис. 5. содержание класс «плановый прием» из предобработать симптом быть составить биграмм и триграммы. дальнейший логика быть такова: если в предобработать текст пациент присутствовать хотя бы один из этот 2-3-граммов, то кейс маркироваться как срочный. в результат мы получить датасет, содержать 41 срочный случай и 231 плановый. базовый идея быть использование модель логистический регрессия и tf-idf векторизатора. однако модель переобучиться из-за несбалансированность класс и присутствие в «несрочном» класс большой количество шум (класс содержать просьба пациент интерпретировать результат анализов) – рис.5. поэтому следующий шаг стать обучение нейросеть на self attention. для каждый слово быть взять word2vec-эмбеддинги, затем self attention быть использовать для анализ контекст каждый слова. в итог получить следующий метрика качество модель маркировка срочности: accuracy = 0.93 и f1 = 0.96. 4. заключение в настоящий время коллектив автор работать над улучшение значение метрика качество и планировать измерять качество модуль за счёт привлечение медицинский эксперт для тестирования. кроме того, набор дать планироваться дополнить новый случаями. на наш взгляд, текущий тест показывают, что модуль применимый на практике. набор дать и библиотека находиться в свободный доступ на github (https://github.com/nirma-patient-intake).